let gridContainer=document.getElementById("gridId"),gridColRow=8,gridCells=[],gridDict={1:0,2:0,3:0,4:0,5:0,6:0};var score=0;let performanceIndex=0;var roundsCompleted=0;let currentStage="setup",hunterModel="",obstacleModel="",equalyLikely=!0,noTreasure=!0;function grid(){for(let t=0;t<gridColRow;t++)for(let e=0;e<gridColRow;e++){var o=document.createElement("div");o.classList.add("grid-item"),o.setAttribute("id",""+t+e),o.setAttribute("name","empty"),o.textContent=" ",gridCells.push(o),gridContainer.appendChild(o)}}function emptyGrid(){var e=Math.floor(Math.random()*gridColRow),t=Math.floor(Math.random()*gridColRow);document.getElementById(""+e+t).setAttribute("name","emptyGrid")}grid(),emptyGrid();let hunterRowPosition=0,hunterColumnPosition=0,occupiedCells=new Set;function randomHunterSetup(){var e=Math.floor(4*Math.random()),t=Math.floor(4*Math.random()),o=""+e+t,n=document.getElementById(o);n&&!occupiedCells.has(o)?(n.setAttribute("name","hunter"),n.innerHTML="&#129312;",hunterRowPosition=e,hunterColumnPosition=t,occupiedCells.add(o)):randomHunterSetup()}function randomObstacleSetup(){let e=0;for(;e<10;){var t=""+Math.floor(Math.random()*gridColRow)+Math.floor(Math.random()*gridColRow),o=document.getElementById(t);o&&!occupiedCells.has(t)&&(o.setAttribute("name","obstacle"),o.innerHTML="&#128507;",occupiedCells.add(t),e++)}}function randomTreasureSetup(){let o=[],e=([1,2,3,4,5,6].forEach(t=>{for(let e=0;e<3;e++)o.push(t)}),o=o.sort(()=>Math.random()-.5),0);for(;e<o.length;){var t,n=""+Math.floor(Math.random()*gridColRow)+Math.floor(Math.random()*gridColRow),r=document.getElementById(n);r&&!occupiedCells.has(n)&&(t=o[e],r.textContent=t,r.setAttribute("name","treasure"),r.classList.add("treasureCoin"),gridDict[t]=(gridDict[t]||0)+1,occupiedCells.add(n),e++)}}function randomTreasureObstacle(e){var t=e[Math.floor(Math.random()*e.length)];console.log("treasureValue",t);let o=!1;for(;!o;){var n=""+Math.floor(Math.random()*gridColRow)+Math.floor(Math.random()*gridColRow),r=document.getElementById(n);r&&!occupiedCells.has(n)&&(equalyLikely=equalyLikely?(r.textContent=t,r.setAttribute("name","treasure"),r.classList.add("treasureCoin"),gridDict[t]=(gridDict[t]||0)+1,!1):(r.setAttribute("name","obstacle"),r.innerHTML="&#128507",obstacleModel=r.innerHTML,r.textContent=obstacleModel,!0),occupiedCells.add(n),o=!0)}}console.log("occupiedCells",occupiedCells),randomHunterSetup(),randomObstacleSetup(),randomTreasureSetup();let hunterTreasureBag=[];function hunterMovement(){document.addEventListener("keydown",function(o){if("end"!==currentStage){var n,o=o.key.toLowerCase();let e=hunterRowPosition,t=hunterColumnPosition;switch(document.getElementById("error").textContent="",o){case"w":e=hunterRowPosition-1;break;case"a":t=hunterColumnPosition-1;break;case"s":e=hunterRowPosition+1;break;case"d":t=hunterColumnPosition+1;break;default:return void dialogueBox("Invalid key pressed! Use W, A, S, or D to move the hunter.")}e<0||e>=gridColRow||t<0||t>=gridColRow?dialogueBox("Cannot move beyond grid boundaries!"):(o=document.getElementById(""+e+t).getAttribute("name"))&&"obstacle"===o?dialogueBox("Cannot move to an obstacle cell!"):((o=document.getElementById(""+hunterRowPosition+hunterColumnPosition)).textContent="",o.classList.remove("hunterModel"),hunterRowPosition=e,hunterColumnPosition=t,o=document.getElementById(""+hunterRowPosition+hunterColumnPosition),predObstacle(hunterRowPosition,hunterColumnPosition),n=o.textContent,o.innerHTML="&#129312;",o.classList.add("hunterModel"),o.classList.remove("treasureCoin"),["1","2","3","4","5","6"].includes(n)&&(console.log("here"),randomTreasureObstacle(n),occupiedCells.delete(""+hunterRowPosition+hunterColumnPosition),document.getElementById("MessageHeader").style.display="none",document.getElementById("Message").style.display="none",hunterTreasureBag.length<=2?(hunterTreasureBag.push(n),updateTreasureDisplay(),3==hunterTreasureBag.length&&CaculateTreasure(hunterTreasureBag)):(hunterTreasureBag.splice(0,hunterTreasureBag.length),hunterTreasureBag.push(n),updateTreasureDisplay())),roundsCompleted++,updateStatus())}})}function updateTreasureDisplay(){document.getElementById("hunterTreasureBag").textContent=`[${hunterTreasureBag.join(", ")}]`}function CaculateTreasure(...e){var t=+e[0][0],o=+e[0][1],e=+e[0][2],n=[t,o,e],r=(n.sort((e,t)=>e-t),!1),r=!!(n[0]+1==n[1]&n[1]+1==n[2]);let a=0,l=t+o+e;n=document.getElementById("Message");document.getElementById("MessageHeader").style.display="block",document.getElementById("Message").style.display="block",console.log("num1",t),t==o&&o==e?(console.log("cond1"),a=300+l,n.textContent=`When all three treasures have same values 300 + ${hunterTreasureBag.join(" + ")} = `+a):t==o||o==e||e==t?(console.log("cond2"),a=200+l,n.textContent=`Two but not 3 treasures have same values 200 + ${hunterTreasureBag.join(" + ")} = `+a):1==r?(console.log("cond3"),a=100+l,n.textContent=`A run 100 + ${hunterTreasureBag.join(" + ")} = `+a):t!=o&&o!=e&&e!=t&&(console.log("cond4"),a=l,n.textContent=`All treasures have different values, but it is not a run ${hunterTreasureBag.join(" + ")} = `+a),score+=a,console.log("points",a)}function updateStatus(){document.getElementById("roundsCompleted").textContent=roundsCompleted,document.getElementById("score").textContent=score,document.getElementById("performanceIndex").textContent=performanceIndex;noTreasure=[5,6,7,8].every(e=>0===gridDict[e])}function endGame(){currentStage="end",performanceIndexCalc(),document.getElementById("status").style.display="block",document.getElementById("performanceIndexP").style.display="block",document.getElementById("finaltag").style.display="block",document.getElementById("endSetupButton").style.display="none",updateStatus()}function predObstacle(e,t){var o;for(o of[{x:+e-1,y:+t},{x:+e+1,y:+t},{x:+e,y:+t-1},{x:+e,y:+t+1}]){console.log("cell",o);var n=document.getElementById(""+o.x+o.y);console.log("nextCell",n),0<o.x&&0<o.y&&o.x<7&&o.y<7&&"obstacle"===(typeName=n.getAttribute("name"))&&console.log("plpl")}}function performanceIndexCalc(){0<roundsCompleted&&(performanceIndex=(score/roundsCompleted).toFixed(2))}function dialogueBox(e){document.getElementById("dialogueBox").style.display="block",document.getElementById("dialogueBox-message").innerText=e,currentStage="end"}function closeDialogueBox(){document.getElementById("dialogueBox").style.display="none",currentStage="play"}hunterMovement(),document.getElementById("status").style.display="block",document.getElementById("roundsCompleted").textContent=roundsCompleted;
